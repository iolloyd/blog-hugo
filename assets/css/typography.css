/* Enhanced Typography System
   Building on the Apple-inspired design with:
   - Content-specific typography scales
   - Variable font support with fallbacks
   - Vertical rhythm system
   - Accessibility features
*/

/* Variable Font Support */
@supports (font-variation-settings: normal) {
  @font-face {
    font-family: 'Inter var';
    font-style: normal;
    font-weight: 100 900;
    font-display: swap;
    src: url('../fonts/inter-var.woff2') format('woff2-variations');
    unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
  }
}

/* Enhanced Typography Variables */
:root {
  /* Content-specific type scales */
  --article-font-size: clamp(1.125rem, 2vw + 1rem, 1.25rem);
  --article-line-height: 1.7;
  --article-paragraph-spacing: 1.5em;
  --article-max-width: 65ch;
  
  /* UI-specific typography */
  --ui-font-size: 1rem;
  --ui-line-height: 1.4;
  --ui-compact-size: 0.875rem;
  
  /* Navigation typography */
  --nav-font-size: 1.0625rem;
  --nav-line-height: 1.2;
  --nav-letter-spacing: -0.01em;
  
  /* Vertical rhythm unit (8px baseline) */
  --baseline: 0.5rem;
  --baseline-2x: 1rem;
  --baseline-3x: 1.5rem;
  --baseline-4x: 2rem;
  
  /* Enhanced font stacks */
  --font-system-enhanced: 'Inter var', var(--font-system);
  --font-dyslexia: 'OpenDyslexic', 'Comic Sans MS', var(--font-system);
  
  /* Font loading states */
  --font-loaded: 0;
  
  /* Refined mobile scales */
  --mobile-scale-factor: 0.9;
  --mobile-line-height-boost: 0.1;
}

/* Font Loading Classes */
.fonts-loaded {
  --font-loaded: 1;
}

.fonts-loaded body {
  font-family: var(--font-system-enhanced);
}

/* Critical Input Field Sizing - Prevent iOS Zoom */
input[type="text"],
input[type="email"],
input[type="password"],
input[type="tel"],
input[type="url"],
input[type="search"],
input[type="number"],
input[type="date"],
input[type="time"],
select,
textarea {
  font-size: 16px !important; /* Never below 16px on mobile */
  line-height: 1.5;
}

/* Article Content Typography */
.article-content {
  font-size: var(--article-font-size);
  line-height: var(--article-line-height);
  font-feature-settings: 'kern' 1, 'liga' 1, 'calt' 1;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.article-content p {
  margin-bottom: var(--article-paragraph-spacing);
  max-width: var(--article-max-width);
}

.article-content h1,
.article-content h2,
.article-content h3,
.article-content h4,
.article-content h5,
.article-content h6 {
  margin-top: calc(var(--baseline) * 6);
  margin-bottom: calc(var(--baseline) * 3);
  line-height: var(--leading-tight);
  font-weight: 600;
  letter-spacing: var(--tracking-tight);
}

.article-content h1 { font-size: clamp(2rem, 5vw, 2.5rem); }
.article-content h2 { font-size: clamp(1.5rem, 4vw, 2rem); }
.article-content h3 { font-size: clamp(1.25rem, 3vw, 1.5rem); }
.article-content h4 { font-size: clamp(1.125rem, 2.5vw, 1.25rem); }

.article-content blockquote {
  padding-left: var(--baseline-3x);
  margin: var(--baseline-4x) 0;
  border-left: 3px solid var(--apple-gray-light);
  font-style: italic;
}

.article-content code {
  font-family: var(--font-mono);
  font-size: 0.875em;
  padding: 0.125em 0.25em;
  background-color: var(--apple-gray-lighter);
  border-radius: 3px;
}

.article-content pre {
  margin: var(--baseline-4x) 0;
  padding: var(--baseline-2x);
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

/* UI Typography */
.ui-text {
  font-size: var(--ui-font-size);
  line-height: var(--ui-line-height);
  letter-spacing: normal;
}

.ui-text-compact {
  font-size: var(--ui-compact-size);
  line-height: var(--ui-line-height);
}

/* Navigation Typography */
.nav-text {
  font-size: var(--nav-font-size);
  line-height: var(--nav-line-height);
  letter-spacing: var(--nav-letter-spacing);
  font-weight: 500;
}

/* Vertical Rhythm Classes */
.rhythm-tight { margin-bottom: var(--baseline); }
.rhythm-normal { margin-bottom: var(--baseline-2x); }
.rhythm-relaxed { margin-bottom: var(--baseline-3x); }
.rhythm-loose { margin-bottom: var(--baseline-4x); }

/* Accessibility Features */

/* Dyslexia Mode */
.dyslexia-mode {
  font-family: var(--font-dyslexia) !important;
  letter-spacing: 0.05em !important;
  word-spacing: 0.1em !important;
  line-height: 1.8 !important;
}

.dyslexia-mode p,
.dyslexia-mode li {
  margin-bottom: 1.5em !important;
}

/* Font Size Adjustments */
.font-size-small { font-size: 90% !important; }
.font-size-normal { font-size: 100% !important; }
.font-size-large { font-size: 110% !important; }
.font-size-xlarge { font-size: 125% !important; }

/* High Contrast Mode */
@media (prefers-contrast: high) {
  body {
    font-weight: 500;
  }
  
  .article-content {
    font-weight: 400;
  }
}

/* Reduced Motion */
@media (prefers-reduced-motion: reduce) {
  * {
    transition-duration: 0.01ms !important;
  }
}

/* Mobile-Specific Adjustments */
@media (max-width: 768px) {
  /* Ensure all interactive elements are touch-friendly */
  button,
  a,
  .clickable {
    min-height: 44px;
    display: inline-flex;
    align-items: center;
  }
  
  /* Article content adjustments */
  .article-content {
    font-size: 1.125rem; /* 18px base */
    line-height: 1.75;
  }
  
  .article-content h1 { font-size: 2rem; }
  .article-content h2 { font-size: 1.625rem; }
  .article-content h3 { font-size: 1.375rem; }
  .article-content h4 { font-size: 1.125rem; }
  
  /* Improved readability for long-form content */
  .article-content p {
    margin-bottom: 1.75em;
    text-align: left;
    hyphens: auto;
    -webkit-hyphens: auto;
  }
  
  /* Better list spacing */
  .article-content ul,
  .article-content ol {
    margin-bottom: var(--baseline-3x);
    padding-left: 1.5em;
  }
  
  .article-content li {
    margin-bottom: var(--baseline);
  }
}

/* Smallest devices (iPhone SE) */
@media (max-width: 375px) {
  :root {
    --article-font-size: 1.0625rem; /* 17px */
  }
  
  .article-content h1 { font-size: 1.75rem; }
  .article-content h2 { font-size: 1.5rem; }
}